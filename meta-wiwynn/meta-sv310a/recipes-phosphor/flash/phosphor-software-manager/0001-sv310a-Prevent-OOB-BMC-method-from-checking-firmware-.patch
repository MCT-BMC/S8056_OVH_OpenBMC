From 219e22a07b64918e5681b673f86f07e2bb6b6d66 Mon Sep 17 00:00:00 2001
From: Alwin Joseph <alwinj@twitter.com>
Date: Tue, 10 Nov 2020 17:15:13 +0000
Subject: [PATCH] [sv310a] Prevent OOB BMC method from checking firmware version

---
 image_manager.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/image_manager.cpp b/image_manager.cpp
index 36ec0bc..ea5cc69 100644
--- a/image_manager.cpp
+++ b/image_manager.cpp
@@ -174,6 +174,10 @@ int Manager::processImage(const std::string& tarFilePath)
     // Compute id
     auto id = Version::getId(version);
 
+    //Prevent comparing current version with flashed version
+    srand(time(NULL));
+    id = id + "_" + std::to_string(rand());
+
     fs::path imageDirPath = std::string{IMG_UPLOAD_DIR};
     imageDirPath /= id;
 
